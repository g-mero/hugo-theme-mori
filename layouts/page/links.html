{{ define "main" }}
  <section class="mb-lg md:mb-xl mt-xl">
    <div class="mb-sm">
      <a class="fs-base border-none inline c-main" href="{{relLangURL ""}}" ><span class="icon i-arrow-left-alt"></span>Back</a>
      <div class="fs-sm c-fg2 border-none inline-flex items-center bg-bg1 px-md py-xs lh-tight rounded-lg ml-xs md:ml-sm">Page</div>
    </div>

    <h1 class="fs-xl font-600 m-0 mb-xs lh-tight break-all">{{ .Title }}</h1>
    {{ with .Content }}
      <div class="prose fs-base lh-relaxed c-fg3 mb-md">
        {{ . }}
      </div>
    {{ end }}
  </section>

  {{ with site.Data.links }}
    {{/* Collect all groups from data/links/ directory */}}
    {{ $allGroups := slice }}
    {{ range $key, $value := . }}
      {{ if ne $key "settings" }}
        {{ $allGroups = $allGroups | append $value }}
      {{ end }}
    {{ end }}

    {{/* Merge groups with same name */}}
    {{ $groupsMap := dict }}
    {{ range $allGroups }}
      {{ $groupName := .name }}
      {{ if isset $groupsMap $groupName }}
        {{/* Merge items into existing group */}}
        {{ $existing := index $groupsMap $groupName }}
        {{ $mergedItems := $existing.items | append .items }}
        {{ $groupsMap = merge $groupsMap (dict $groupName (merge $existing (dict "items" $mergedItems))) }}
      {{ else }}
        {{/* Add new group */}}
        {{ $groupsMap = merge $groupsMap (dict $groupName .) }}
      {{ end }}
    {{ end }}

    {{/* Convert map back to slice */}}
    {{ $groups := slice }}
    {{ range $key, $value := $groupsMap }}
      {{ $groups = $groups | append $value }}
    {{ end }}

    {{ $groups := sort $groups "weight" "asc" }}

    <section class="mt-xl">
      {{ range $groups }}
        <div class="mb-xl last:mb-0">
          <h2 class="fs-base font-600 m-0 mb-md pb-xs border-b border-bd1 c-main">{{ partial "get-localized.html" (dict "data" . "field" "name") }}</h2>
          {{ $items := sort .items "weight" "asc" }}
          {{ partial "links-list.html" (dict "groups" (slice .) "limit" 0 "showGroupName" false) }}
        </div>
      {{ end }}
    </section>
  {{ end }}
{{ end }}
